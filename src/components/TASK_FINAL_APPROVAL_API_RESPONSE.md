# ูพุงุณุฎ ุชู ุจฺฉูุฏ - API ุชุฃุฏ ููุง ูุธุงู ุขูุงุฏู ุงุณุช! โ

## ุฎูุงุตู

ุณุณุชู ฺฉุงูู ุชุฃุฏ ููุง ูุธุงู ูพุงุฏูโุณุงุฒ ุดุฏู ู ุขูุงุฏู ุงุณุชูุงุฏู ุงุณุช. ููู API ูุง ุฏุฑุฎูุงุณุช ุดูุง ุจุง ููููุช ุชุณุช ุดุฏูโุงูุฏ.

## โ ุชุบุฑุงุช ุงูุฌุงู ุดุฏู ุฏุฑ ุฏุชุงุจุณ

### ููุฏูุง ุฌุฏุฏ ุฏุฑ ุฌุฏูู tasks:
- `is_approved` (Boolean) - ุขุง ูุธูู ุชุฃุฏ ุดุฏู ุงุณุชุ
- `approved_by_id` (UUID) - ุดูุงุณู ฺฉุงุฑุจุฑ ุชุฃุฏ ฺฉููุฏู
- `approved_at` (Timestamp) - ุฒูุงู ุชุฃุฏ
- `approval_note` (Text) - ุงุฏุฏุงุดุช ุชุฃุฏ (ุงุฎุชุงุฑ)

### Migration ููููุชโุขูุฒ:
โ Migration ุงุฌุฑุง ุดุฏู ู ุฏุชุงุจุณ ุขูพุฏุช ุดุฏู
โ ุงูุฏฺฉุณโูุง ููุงุณุจ ุจุฑุง ุจูุจูุฏ ุนููฺฉุฑุฏ ุงุถุงูู ุดุฏู

## ๐ง API ูุง ูพุงุฏูโุณุงุฒ ุดุฏู

### 1. ุชุฃุฏ ููุง ูุธูู
```
PUT /api/tasks/{task_id}/approve
```

**Request Body:**
```json
{
  "approval_note": "ูุธูู ุจุง ฺฉูุช ููุงุณุจ ุงูุฌุงู ุดุฏู ุงุณุช" // ุงุฎุชุงุฑ
}
```

**Response:**
```json
{
  "task": {
    "id": "task-uuid",
    "title": "ุนููุงู ูุธูู",
    "status": "done",
    "is_approved": true,
    "approved_by": {
      "id": "user-uuid",
      "full_name": "ุงุญูุฏ ูุฏุฑ",
      "email": "admin@example.com"
    },
    "approved_at": "2025-12-27T10:30:00Z",
    "approval_note": "ูุธูู ุจุง ฺฉูุช ููุงุณุจ ุงูุฌุงู ุดุฏู ุงุณุช",
    "is_creator": false,
    // ุณุงุฑ ููุฏูุง ูุนููู...
  }
}
```

### 2. ูุบู ุชุฃุฏ ููุง
```
DELETE /api/tasks/{task_id}/approve
```

**Response:**
```json
{
  "task": {
    "id": "task-uuid",
    "title": "ุนููุงู ูุธูู",
    "status": "done",
    "is_approved": false,
    "approved_by": null,
    "approved_at": null,
    "approval_note": null,
    // ุณุงุฑ ููุฏูุง...
  }
}
```

### 3. ููุชุฑ ูุธุงู ุจุฑ ุงุณุงุณ ุชุฃุฏ
```
GET /api/tasks?approved={true|false|all}
```

**Query Parameters:**
- `approved=true` - ููุท ูุธุงู ุชุฃุฏ ุดุฏู
- `approved=false` - ููุท ูุธุงู ุชุฃุฏ ูุดุฏู  
- `approved=all` ุง ุจุฏูู ูพุงุฑุงูุชุฑ - ููู ูุธุงู

### 4. ุขูพุฏุช ุดุฏู: GET /api/tasks
ููู ูุธุงู ุญุงูุง ุดุงูู ููุฏูุง ุชุฃุฏ ูุณุชูุฏ:

```json
[
  {
    "id": "task-uuid",
    "title": "ุนููุงู ูุธูู",
    "status": "done",
    "is_approved": false,
    "approved_by": null,
    "approved_at": null,
    "approval_note": null,
    "is_creator": true,
    // ุณุงุฑ ููุฏูุง ููุฌูุฏ...
  }
]
```

## ๐ ููุงูู ุฏุณุชุฑุณ ูพุงุฏูโุณุงุฒ ุดุฏู

### โ ูุฌูุฒูุง ุชุฃุฏ:
1. **ููุท ูุฏุฑุงู** (`role: "admin"`) ูโุชูุงููุฏ ุชุฃุฏ ฺฉููุฏ
2. **ููุท ูุธุงู `done`** ูุงุจู ุชุฃุฏ ูุณุชูุฏ
3. **ุณุงุฒูุฏู ููโุชูุงูุฏ** ูุธูู ุฎูุฏุด ุฑุง ุชุฃุฏ ฺฉูุฏ
4. **ูุธุงู ุชุฃุฏ ุดุฏู** ูุงุจู ูุบู ุชุฃุฏ ูุณุชูุฏ
5. **ุงุนูุงู ุฎูุฏฺฉุงุฑ** ุจู ุณุงุฒูุฏู ุงุฑุณุงู ูโุดูุฏ

### ๐ซ ูพุงูโูุง ุฎุทุง ูพุงุฏูโุณุงุฒ ุดุฏู:
- `"ููุท ูุฏุฑุงู ูโุชูุงููุฏ ูุธุงู ุฑุง ุชุฃุฏ ฺฉููุฏ"`
- `"ููุท ูุธุงู ุงูุฌุงู ุดุฏู ูุงุจู ุชุฃุฏ ูุณุชูุฏ"`
- `"ููโุชูุงูุฏ ูุธูู ุฎูุฏุชุงู ุฑุง ุชุฃุฏ ฺฉูุฏ"`
- `"ุงู ูุธูู ูุจูุงู ุชุฃุฏ ุดุฏู ุงุณุช"`

## ๐งช ุชุณุชโูุง ุงูุฌุงู ุดุฏู

### โ ุชุณุช ูููู:
```bash
# ุฏุฑุงูุช ููู ูุธุงู ุจุง ููุฏูุง ุฌุฏุฏ
GET /api/tasks
โ ููุฏูุง is_approved, approved_by, approved_at, approval_note ุงุถุงูู ุดุฏู

# ููุชุฑ ูุธุงู ุชุฃุฏ ูุดุฏู
GET /api/tasks?approved=false
โ ููุท ูุธุงู is_approved=false ุจุฑฺฏุฑุฏุงูุฏู ุดุฏ

# ููุชุฑ ูุธุงู ุชุฃุฏ ุดุฏู
GET /api/tasks?approved=true
โ ุขุฑุงู ุฎุงู (ูููุฒ ูุธูู ุชุฃุฏ ุดุฏูโุง ูุฏุงุฑู)

# ุชูุงุด ุจุฑุง ุชุฃุฏ ูุธูู ุฎูุฏ
PUT /api/tasks/{id}/approve
โ ุฎุทุง ููุงุณุจ: "ููโุชูุงูุฏ ูุธูู ุฎูุฏุชุงู ุฑุง ุชุฃุฏ ฺฉูุฏ"
```

## ๐ฏ ูุญูู ุงุณุชูุงุฏู ุฏุฑ ูุฑุงูุชโุงูุฏ

### 1. ููุงุด ูุถุนุช ุชุฃุฏ:
```javascript
// ฺฺฉ ฺฉุฑุฏู ูุถุนุช ุชุฃุฏ
if (task.is_approved) {
  // ููุงุด ูุดุงู "ุชุฃุฏ ุดุฏู" + ุขฺฉูู ุขุฑุดู
  showApprovedBadge(task.approved_by.full_name, task.approved_at)
} else if (task.status === 'done') {
  // ููุงุด "ุฏุฑ ุงูุชุธุงุฑ ุชุฃุฏ"
  showPendingApprovalBadge()
}
```

### 2. ููุงุด ุฏฺฉููโูุง ูุฏุฑุช:
```javascript
// ููุท ุจุฑุง ูุฏุฑุงู
if (user.role === 'admin' && task.status === 'done' && !task.is_approved && !task.is_creator) {
  showApproveButton(task.id)
}

if (user.role === 'admin' && task.is_approved) {
  showUnapproveButton(task.id)
}
```

### 3. ููุชุฑ ูุธุงู:
```javascript
// ุชุจโูุง ูุฎุชูู
const fetchTasks = async (filter) => {
  const response = await fetch(`/api/tasks?approved=${filter}`, {
    headers: { 'Authorization': `Bearer ${token}` }
  })
  return response.json()
}

// ููู ูุธุงู
const allTasks = await fetchTasks('all')

// ุขุฑุดู (ุชุฃุฏ ุดุฏู)
const approvedTasks = await fetchTasks('true')

// ุฏุฑ ุงูุชุธุงุฑ ุชุฃุฏ
const pendingTasks = await fetchTasks('false')
```

### 4. ุชุฃุฏ ูุธูู:
```javascript
const approveTask = async (taskId, note) => {
  const response = await fetch(`/api/tasks/${taskId}/approve`, {
    method: 'PUT',
    headers: {
      'Authorization': `Bearer ${token}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      approval_note: note
    })
  })
  
  if (response.ok) {
    const result = await response.json()
    // ุขูพุฏุช UI
    updateTaskInList(result.task)
    showSuccessMessage('ูุธูู ุจุง ููููุช ุชุฃุฏ ุดุฏ')
  }
}
```

## ๐ ุงุนูุงูโูุง ูพุงุฏูโุณุงุฒ ุดุฏู

### ุงุนูุงูโูุง ุฎูุฏฺฉุงุฑ:
1. **ุชุฃุฏ ูุธูู**: ุจู ุณุงุฒูุฏู ุงุฑุณุงู ูโุดูุฏ
   - ููุน: `task_approved`
   - ูพุงู: `"ูุธูู [ุนููุงู] ุชูุณุท [ูุฏุฑ] ุชุฃุฏ ููุง ุดุฏ"`

2. **ูุบู ุชุฃุฏ**: ุจู ุณุงุฒูุฏู ุงุฑุณุงู ูโุดูุฏ
   - ููุน: `task_unapproved`
   - ูพุงู: `"ุชุฃุฏ ูุธูู [ุนููุงู] ุชูุณุท [ูุฏุฑ] ูุบู ุดุฏ"`

## ๐ ูพุดููุงุฏุงุช UI/UX

### 1. ููุงุด ูุถุนุช:
- **ุชุฃุฏ ุดุฏู**: ูุดุงู ุณุจุฒ + ุขฺฉูู ุขุฑุดู
- **ุฏุฑ ุงูุชุธุงุฑ ุชุฃุฏ**: ูุดุงู ุฒุฑุฏ + ุขฺฉูู ุณุงุนุช
- **ุนุงุฏ**: ุจุฏูู ูุดุงู ุฎุงุต

### 2. ููุชุฑูุง:
- ุชุจ "ููู ูุธุงู" (ูพุดโูุฑุถ)
- ุชุจ "ุขุฑุดู" (ุชุฃุฏ ุดุฏู)
- ุชุจ "ุฏุฑ ุงูุชุธุงุฑ ุชุฃุฏ" (done ุงูุง approved ูุดุฏู)

### 3. ุฏฺฉููโูุง ุนููุงุช:
- **ุจุฑุง ูุฏุฑุงู**: "ุชุฃุฏ ููุง" / "ูุบู ุชุฃุฏ"
- **ุจุฑุง ุณุงุฑู**: ููุท ูุดุงูุฏู ูุถุนุช

## ๐ ุขูุงุฏู ุจุฑุง ุงุณุชูุงุฏู

ููู ฺุฒ ุขูุงุฏู ุงุณุช! ูโุชูุงูุฏ:

1. **ููุฏูุง ุฌุฏุฏ ุฑุง ููุงุด ุฏูุฏ** - ุฏุฑ ูุณุช ูุธุงู
2. **ููุชุฑูุง ุฑุง ูพุงุฏูโุณุงุฒ ฺฉูุฏ** - ุจุฑุง ุขุฑุดู ู ุงูุชุธุงุฑ ุชุฃุฏ
3. **ุฏฺฉููโูุง ุชุฃุฏ ุงุถุงูู ฺฉูุฏ** - ุจุฑุง ูุฏุฑุงู
4. **ุงุนูุงูโูุง ุฑุง ููุงุด ุฏูุฏ** - ุชุฃุฏ/ูุบู ุชุฃุฏ

## ๐ ุขูุงุฑ ูพุงุฏูโุณุงุฒ

- โ **4 ููุฏ ุฌุฏุฏ** ุจู ุฏุชุงุจุณ ุงุถุงูู ุดุฏู
- โ **2 API endpoint ุฌุฏุฏ** ูพุงุฏูโุณุงุฒ ุดุฏู
- โ **1 API ููุฌูุฏ** ุขูพุฏุช ุดุฏู (ููุชุฑ)
- โ **ููู ูุฌูุฒูุง** ูพุงุฏูโุณุงุฒ ุดุฏู
- โ **ุงุนูุงูโูุง ุฎูุฏฺฉุงุฑ** ูุนุงู
- โ **ููู ุชุณุชโูุง** ูููู

ุงฺฏุฑ ุณูุงู ุง ูุดฺฉู ุฏุงุดุชุฏุ ุงุทูุงุน ุฏูุฏ! ๐ฏ

---

**ุชู ุจฺฉูุฏ**  
ุชุงุฑุฎ: ท ุฏ ฑดฐด